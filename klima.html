<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conny V3 | Public View - Klimawandel</title>
    <!-- Wir nutzen Vis.js f√ºr den Graphen -->
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <!-- Phosphor Icons f√ºr moderne Optik -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <style>
        /* --- 1. DESIGN SYSTEM (CYBER-PHYSICAL) --- */
        :root {
            --bg: #0f172a;            /* Deep Space */
            --panel: #1e293b;        /* Surface */
            --border: #334155;
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            
            /* Logic Colors */
            --accent-deep: #38bdf8;  /* Deep Dive (Logic) */
            --accent-connect: #4ade80; /* Connect (Social) */
            --accent-flow: #f472b6;  /* Flow (Media) */
            
            --private-color: #64748b; /* Private Node */
            --project-color: #f59e0b; /* Project Anchor (Amber) */
            --public-color: #f8fafc;  /* Public Hub */
            
            /* Topic Specific */
            --climate-green: #10b981;
            --climate-alert: #ef4444;
        }

        body {
            margin: 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--text-main);
            overflow: hidden;
            height: 100vh;
            display: grid;
            grid-template-columns: 260px 1fr; /* Sidebar | Main */
            grid-template-rows: 60px 1fr;     /* Header | Content */
        }

        /* --- 2. LAYOUT COMPONENTS --- */
        
        /* HEADER */
        header {
            grid-column: 1 / -1;
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 100;
        }

        .breadcrumb { font-weight: 500; font-size: 1rem; display:flex; align-items:center; gap:10px; color: var(--text-muted); }
        .breadcrumb span { color: var(--text-main); font-weight: 700; }
        .breadcrumb i { font-size: 1.2rem; }

        .omni-search-container { position: relative; width: 400px; max-width: 100%; }
        .omni-input {
            width: 100%; background: var(--panel); border: 1px solid var(--border);
            color: white; padding: 8px 40px 8px 15px; border-radius: 8px; font-size: 0.9rem; transition: all 0.2s; box-sizing: border-box;
        }
        .omni-input:focus { border-color: var(--climate-green); box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.2); outline: none; }
        .search-icon { position: absolute; right: 12px; top: 10px; color: var(--text-muted); }
        
        .user-profile { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; cursor: pointer; }
        .avatar { width: 32px; height: 32px; border-radius: 50%; background: var(--accent-deep); display: flex; align-items: center; justify-content: center; font-weight: bold; color: black; }

        /* SIDEBAR */
        aside {
            grid-row: 2 / -1;
            background: var(--panel);
            border-right: 1px solid var(--border);
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 25px;
            overflow-y: auto;
        }

        .lens-group-title { font-size: 0.7rem; text-transform: uppercase; color: var(--text-muted); font-weight: 700; margin-bottom: 10px; letter-spacing: 1px; }
        .nav-category { font-size: 0.95rem; font-weight: 600; color: white; margin-bottom: 5px; display: flex; align-items: center; gap: 8px; cursor: pointer; }
        .nav-category:hover { color: var(--accent-deep); }
        
        .lens-item { display: flex; align-items: center; gap: 10px; padding: 8px 12px; border-radius: 6px; color: var(--text-muted); cursor: pointer; transition: 0.2s; font-size: 0.9rem; }
        .lens-item:hover { background: rgba(255,255,255,0.05); color: white; }
        .lens-item.active { background: rgba(56, 189, 248, 0.1); color: var(--accent-deep); border-left: 3px solid var(--accent-deep); }
        .lens-item i { font-size: 1.1rem; }
        .lens-sub-item { padding-left: 34px; font-size: 0.85rem; color: var(--text-muted); display:flex; align-items:center; gap:8px; cursor:pointer; padding-top:5px; padding-bottom:5px; border-radius:4px; }
        .lens-sub-item:hover { color: white; background: rgba(255,255,255,0.03); }

        /* MAIN CONTENT AREA */
        main {
            grid-column: 2 / -1;
            grid-row: 2 / -1;
            position: relative;
            background: radial-gradient(circle at center, #1e293b 0%, #0f172a 100%);
            overflow: hidden;
            min-width: 0; /* Prevents grid blowout */
        }

        /* --- 2.5 TOOLS PALETTE (COLLAPSIBLE) --- */
        #tools-trigger {
            position: absolute; top: 20px; left: 20px; z-index: 61;
            width: 40px; height: 40px; background: var(--panel); border: 1px solid var(--border);
            border-radius: 8px; display: flex; align-items: center; justify-content: center;
            cursor: pointer; color: var(--text-muted); transition: 0.2s;
        }
        #tools-trigger:hover { color: white; border-color: var(--accent-deep); }

        #tools-panel {
            position: absolute; top: 70px; left: 20px;
            width: 40px; 
            background: var(--panel); border: 1px solid var(--border); border-radius: 12px;
            display: flex; flex-direction: column; align-items: center;
            padding: 10px 0; gap: 10px; z-index: 60;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            
            /* Animation logic */
            transform: translateX(-150%); /* Start collapsed (off-screenish or hidden) */
            opacity: 0;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s;
            pointer-events: none;
        }
        
        #tools-panel.expanded {
            transform: translateX(0);
            opacity: 1;
            pointer-events: all;
        }

        .tool-btn {
            width: 32px; height: 32px; display: flex; align-items: center; justify-content: center;
            border-radius: 8px; color: var(--text-muted); cursor: pointer; transition: 0.2s; position: relative;
        }
        .tool-btn:hover { background: rgba(255,255,255,0.1); color: white; }
        .tool-btn.active { color: #f59e0b; }
        .tool-separator { width: 20px; height: 1px; background: var(--border); margin: 5px 0; }
        
        /* Tooltips */
        .tool-btn::after {
            content: attr(data-tooltip); position: absolute; left: 45px; top: 50%; transform: translateY(-50%);
            background: black; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.7rem;
            white-space: nowrap; pointer-events: none; opacity: 0; transition: 0.2s; visibility: hidden;
        }
        .tool-btn:hover::after { opacity: 1; visibility: visible; }

        /* --- 3. MODES (VIEW SWITCHER) --- */
        .mode-switcher {
            position: absolute; top: 20px; right: 20px;
            background: rgba(15, 23, 42, 0.9); border: 1px solid var(--border);
            border-radius: 12px; padding: 4px; display: flex; gap: 4px; z-index: 50;
        }
        .mode-btn {
            padding: 8px 16px; border-radius: 8px; border: none; background: transparent;
            color: var(--text-muted); cursor: pointer; font-weight: 600; font-size: 0.85rem;
            display: flex; align-items: center; gap: 6px; transition: 0.3s;
        }
        .mode-btn:hover { color: white; }
        .mode-btn.active-dash { background: rgba(255, 255, 255, 0.1); color: white; }
        .mode-btn.active-deep { background: rgba(56, 189, 248, 0.2); color: var(--accent-deep); }
        .mode-btn.active-connect { background: rgba(74, 222, 128, 0.2); color: var(--accent-connect); }
        .mode-btn.active-flow { background: rgba(244, 114, 182, 0.2); color: var(--accent-flow); }

        /* --- 3.1 COMMUNICATION PANEL --- */
        #comm-panel {
            position: absolute; top: 80px; right: 20px; width: 320px;
            background: var(--panel); border: 1px solid var(--border); border-radius: 12px;
            display: flex; flex-direction: column; z-index: 45; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: max-height 0.3s ease-in-out; overflow: hidden; max-height: 400px;
        }
        #comm-panel.minimized { max-height: 42px; }

        .comm-header { display: flex; align-items: center; justify-content: space-between; background: rgba(0,0,0,0.2); padding: 0 5px; height: 42px; border-bottom: 1px solid var(--border); }
        .comm-tabs { display: flex; gap: 2px; }
        .comm-tab { padding: 10px 12px; font-size: 0.8rem; cursor: pointer; color: var(--text-muted); border-bottom: 2px solid transparent; font-weight: 600; }
        .comm-tab:hover { color: white; }
        .comm-tab.active { color: var(--accent-deep); border-bottom-color: var(--accent-deep); }
        .comm-toggle { color: var(--text-muted); cursor: pointer; padding: 10px; display: flex; align-items: center; justify-content: center; }
        .comm-toggle:hover { color: white; }
        .comm-body { flex: 1; padding: 15px; display: none; overflow-y: auto; height: 250px; background: rgba(0,0,0,0.1); }
        .comm-body.active { display: flex; flex-direction: column; }
        .chat-bubble { background: rgba(255,255,255,0.05); padding: 8px 12px; border-radius: 8px; margin-bottom: 10px; font-size: 0.85rem; }
        .chat-meta { font-size: 0.7rem; color: var(--text-muted); margin-bottom: 2px; display:flex; justify-content:space-between;}

        /* --- 4. VIEW CONTAINERS --- */
        .view-container { width: 100%; height: 100%; display: none; overflow-y: auto; }
        .view-container.active { display: block; animation: fadeIn 0.3s; }

        /* --- NEW DASHBOARD LAYOUT (The 3 Sections) --- */
        #dashboard-container {
            padding: 40px;
            display: none; /* Controlled by JS */
            flex-direction: column;
            gap: 40px;
        }
        #dashboard-container.active { display: flex; }

        .section-title { font-size: 0.9rem; text-transform: uppercase; color: var(--text-muted); font-weight: 700; margin-bottom: 15px; letter-spacing: 1px; display: flex; align-items: center; gap: 8px;}
        
        /* Section 1: Top (Trending Grid) */
        .trending-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
        .trend-card {
            background: rgba(255,255,255,0.03); border: 1px solid var(--border); border-radius: 12px; padding: 15px;
            cursor: pointer; transition: 0.2s; display: flex; flex-direction: column; gap: 10px;
        }
        .trend-card:hover { background: rgba(255,255,255,0.07); border-color: var(--climate-green); transform: translateY(-3px); }
        .trend-icon { font-size: 1.5rem; color: var(--climate-green); }
        .trend-label { font-weight: 600; font-size: 0.95rem; }
        .trend-meta { font-size: 0.75rem; color: var(--text-muted); }

        /* Section 2: Middle (Clusters) - UPDATED TO BE RESPONSIVE */
        .cluster-grid { 
            display: grid; 
            /* Changed from repeat(3, 1fr) to auto-fit for responsiveness */
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; 
        }
        .cluster-panel {
            background: rgba(30, 41, 59, 0.6); border: 1px solid var(--border); border-radius: 16px; padding: 20px; position: relative; overflow: hidden;
        }
        .cluster-panel::before { content:''; position: absolute; top:0; left:0; width:4px; height:100%; background: var(--border); }
        .cluster-panel.science::before { background: var(--accent-deep); }
        .cluster-panel.politics::before { background: var(--project-color); }
        .cluster-panel.activism::before { background: var(--accent-flow); }
        
        .cluster-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px; }
        .cluster-title { font-weight: bold; font-size: 1.1rem; }
        .cluster-stat { display: flex; gap: 15px; margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.05); }
        .stat-box small { display: block; color: var(--text-muted); font-size: 0.7rem; }
        .stat-box strong { font-size: 1rem; }

        /* Section 3: Bottom (Suggestions) */
        .suggestion-list { display: flex; flex-direction: column; gap: 15px; }
        .suggestion-card {
            background: rgba(16, 185, 129, 0.05); border: 1px solid rgba(16, 185, 129, 0.2); border-radius: 12px; padding: 20px;
            display: flex; align-items: center; justify-content: space-between; transition: 0.2s;
        }
        .suggestion-card:hover { background: rgba(16, 185, 129, 0.1); transform: scale(1.01); }
        .sugg-content { display: flex; align-items: center; gap: 15px; flex-wrap: wrap; }
        .sugg-icon { width: 50px; height: 50px; border-radius: 10px; background: rgba(16, 185, 129, 0.2); color: var(--climate-green); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; flex-shrink: 0; }
        
        .sugg-btn { background: var(--climate-green); color: #064e3b; border: none; padding: 8px 16px; border-radius: 6px; font-weight: bold; cursor: pointer; white-space: nowrap; }
        .sugg-btn:hover { filter: brightness(1.1); }
        
        .secondary-sugg { background: rgba(255,255,255,0.03); border-color: var(--border); }
        .secondary-sugg .sugg-icon { background: rgba(255,255,255,0.1); color: var(--text-muted); }
        .secondary-sugg .sugg-btn { background: transparent; border: 1px solid var(--border); color: var(--text-muted); }
        .secondary-sugg .sugg-btn:hover { border-color: white; color: white; }

        /* Existing Views */
        #graph-container { width: 100%; height: 100%; }
        #map-container { 
            background-image: url('https://upload.wikimedia.org/wikipedia/commons/e/ec/Vienna_city_districts_map.svg'); 
            background-size: cover; background-position: center; position: relative; filter: grayscale(80%) invert(90%); height: 100%;
        }
        .map-pin {
            position: absolute; width: 40px; height: 40px; background: var(--accent-connect);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            color: #0f172a; font-weight: bold; border: 2px solid white; box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            animation: pulse 2s infinite; cursor: pointer;
        }
        .map-pin.project-loc { background: var(--climate-green); color:white; border-color:white; animation: none; }
        .map-pin img { width: 36px; height: 36px; border-radius: 50%; }

        #flow-container { padding: 40px; display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
        .flow-card {
            background: var(--panel); border: 1px solid var(--border); border-radius: 16px; overflow: hidden;
            transition: transform 0.2s; cursor: pointer;
        }
        .flow-card:hover { transform: translateY(-5px); border-color: var(--accent-flow); }
        .card-img { height: 160px; background: #334155; display: flex; align-items: center; justify-content: center; color: var(--text-muted); font-size: 3rem;}
        .card-body { padding: 15px; }
        .card-tag { font-size: 0.7rem; color: var(--accent-flow); text-transform: uppercase; font-weight: bold; }
        .card-warning { font-size: 0.7rem; color: #facc15; display: flex; align-items: center; gap: 4px; margin-top: 5px; background: rgba(250, 204, 21, 0.1); padding: 4px; border-radius: 4px;}

        /* POPUP STYLES (RESTORED) */
        #tutorial-popup {
            position: fixed;
            top: 100px;
            right: 50px;
            width: 320px;
            background: white;
            color: #0f172a;
            border-radius: 12px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            z-index: 1000;
            overflow: hidden;
            animation: slideIn 0.5s cubic-bezier(0.16, 1, 0.3, 1);
            transition: height 0.3s ease;
        }
        .popup-header {
            background: linear-gradient(90deg, var(--climate-green), #0ea5e9);
            padding: 12px 15px;
            color: white;
            font-weight: bold;
            cursor: move;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .popup-body { padding: 20px; }
        .popup-footer {
            padding: 15px 20px;
            background: #f1f5f9;
            border-top: 1px solid #e2e8f0;
            text-align: right;
        }
        .btn-tutorial {
            background: #0f172a; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-weight: 600; cursor: pointer; text-decoration: none; display: inline-block; font-size: 0.9rem;
        }
        .btn-tutorial:hover { background: #334155; }
        @keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }


        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(74, 222, 128, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(74, 222, 128, 0); } 100% { box-shadow: 0 0 0 0 rgba(74, 222, 128, 0); } }

    </style>
</head>
<body>

    <!-- HEADER -->
    <header>
        <div class="breadcrumb">
            <i class="ph ph-house" style="cursor:pointer; color:var(--text-muted);" onclick="window.location.href='tour.html'"></i>
            <i class="ph ph-caret-right"></i>
            <span style="display:flex; align-items:center; gap:5px;">
                <i class="ph ph-globe-hemisphere-west" style="color:var(--climate-green);"></i> 
                Meta Hub: Klimawandel
            </span>
        </div>
        
        <div class="omni-search-container">
            <i class="ph ph-magnifying-glass search-icon"></i>
            <input type="text" class="omni-input" placeholder="Suche nach Daten, Initiativen oder News...">
        </div>

        <div class="user-profile">
            <div style="text-align:right; margin-right:10px;">
                <div style="font-weight:bold;">Martin</div>
                <div style="font-size:0.7rem; color:var(--text-muted);">Rep: 85 (Handwerk)</div>
            </div>
            <div class="avatar">M</div>
        </div>
    </header>

    <!-- SIDEBAR -->
    <aside>
        <div>
            <div class="lens-group-title">Navigation</div>
            <div class="nav-category" onclick="window.location.href='tour.html'">
                <i class="ph ph-house-line"></i> Home
            </div>
            <div class="lens-item" onclick="switchLens(this, 'mynodes')">
                <i class="ph ph-tree-structure"></i> Meine Nodes/Hubs
            </div>
            <div class="lens-item" onclick="switchLens(this, 'favorites')">
                <i class="ph ph-star"></i> Favoriten
            </div>
            <div class="lens-item" onclick="switchLens(this, 'history')">
                <i class="ph ph-clock-counter-clockwise"></i> Verlauf
            </div>
            <div class="lens-sub-item" style="margin-top:5px; color:var(--accent-deep);" onclick="alert('Dialog: Neuen Node erstellen')">
                <i class="ph ph-plus-circle"></i> Node erstellen...
            </div>
        </div>

        <div>
            <div class="lens-group-title">Context Lenses</div>
            <div class="lens-item" onclick="switchLens(this, 'science')"><i class="ph ph-atom"></i> Science Data</div>
            <div class="lens-item" onclick="switchLens(this, 'social')"><i class="ph ph-users"></i> Activism</div>
            <div class="lens-item" onclick="switchLens(this, 'regional')"><i class="ph ph-map-pin"></i> Regional (Wien)</div>
            <div class="lens-sub-item" style="margin-top:5px; color:var(--accent-deep);">
                <i class="ph ph-plus-circle"></i> Custom Lens...
            </div>
        </div>

        <div>
            <div class="lens-group-title">Topic Lenses (Bookmarks)</div>
            <div class="lens-item" onclick="window.location.href='node.html'" style="color:var(--text-muted);">
                <i class="ph ph-bookmark-simple"></i> Regal-Projekt
            </div>
            <div class="lens-item"><i class="ph ph-hash"></i> Handwerk</div>
            <div class="lens-item active" style="border-left-color:var(--climate-green); color:var(--climate-green);"><i class="ph ph-globe"></i> Klimawandel</div>
        </div>
    </aside>

    <!-- MAIN AREA -->
    <main>
        
        <!-- TOOLS TRIGGER & PALETTE -->
        <div id="tools-trigger" onclick="toggleToolsPanel()" title="Tools anzeigen">
            <i class="ph ph-toolbox" style="font-size:1.2rem;"></i>
        </div>

        <div id="tools-panel">
            <div class="tool-btn active" data-tooltip="Als Bookmark pinnen" onclick="toggleTool(this)">
                <i class="ph ph-push-pin"></i>
            </div>
            <div class="tool-btn" data-tooltip="Zu Favoriten hinzuf√ºgen" onclick="toggleTool(this)">
                <i class="ph ph-star"></i>
            </div>
            <div class="tool-separator"></div>
            <div class="tool-btn" data-tooltip="Data View">
                <i class="ph ph-chart-line-up"></i>
            </div>
            <div class="tool-btn" data-tooltip="Sources">
                <i class="ph ph-books"></i>
            </div>
            <div class="tool-separator"></div>
             <div class="tool-btn" data-tooltip="Fork erstellen" onclick="alert('Fork Dialog...')">
                <i class="ph ph-git-fork"></i>
            </div>
             <div class="tool-btn" data-tooltip="KI anpassen" onclick="alert('AI Config: Mediator-Pers√∂nlichkeit einstellen...')">
                <i class="ph ph-robot"></i>
            </div>
        </div>

        <!-- MODE SWITCHER -->
        <div class="mode-switcher">
            <button class="mode-btn active-dash" onclick="setMode('dash')">
                <i class="ph ph-squares-four"></i> Meta Hub
            </button>
            <button class="mode-btn" onclick="setMode('connect')">
                <i class="ph ph-users-three"></i> Connect
            </button>
            <button class="mode-btn" onclick="setMode('flow')">
                <i class="ph ph-film-strip"></i> Flow
            </button>
        </div>

        <!-- COMMUNICATION PANEL -->
        <div id="comm-panel">
            <div class="comm-header">
                <div class="comm-tabs">
                    <div class="comm-tab active" onclick="switchCommTab('notes')">Notizen</div>
                    <div class="comm-tab" onclick="switchCommTab('hub')">Meta-Chat</div>
                    <div class="comm-tab" onclick="switchCommTab('dms')">DMs</div>
                </div>
                <div class="comm-toggle" onclick="toggleCommPanel()">
                    <i class="ph ph-caret-up" id="comm-icon"></i>
                </div>
            </div>
            <!-- Tab: Notes -->
            <div id="comm-notes" class="comm-body active">
                <div style="font-size:0.8rem; color:var(--text-muted); margin-bottom:10px;">
                    <i class="ph ph-notebook"></i> Deine Gedanken zum Thema
                </div>
                <textarea style="width:100%; height:100%; flex:1; background:rgba(0,0,0,0.3); border:1px solid var(--border); color:white; border-radius:4px; padding:8px; resize:none; font-family:inherit;" placeholder="- Artikel √ºber CO2-Speicherung lesen...&#10;- Daten f√ºr Wien pr√ºfen..."></textarea>
            </div>
            <!-- Tab: Hub Chat -->
            <div id="comm-hub" class="comm-body">
                 <div style="font-size:0.8rem; color:var(--text-muted); margin-bottom:10px; border-bottom:1px solid var(--border); padding-bottom:5px;">
                    <i class="ph ph-globe"></i> Public Channel: #Climate-General
                </div>
                <div class="chat-bubble">
                    <div class="chat-meta"><span>Sarah_Science</span> <span>09:12</span></div>
                    Neue IPCC Daten sind im "Data"-Node verlinkt. Ziemlich drastisch.
                </div>
                <div class="chat-bubble" style="background:rgba(16, 185, 129, 0.1); border:1px solid rgba(16, 185, 129, 0.3);">
                    <div class="chat-meta"><span style="color:var(--climate-green);">Du</span> <span>09:15</span></div>
                    Danke, ich schau mir die regionalen Auswirkungen f√ºr √ñsterreich an.
                </div>
                <input type="text" placeholder="Nachricht schreiben..." style="background:rgba(0,0,0,0.3); border:1px solid var(--border); color:white; border-radius:4px; padding:8px; margin-top:auto;">
            </div>
            <!-- Tab: DMs -->
            <div id="comm-dms" class="comm-body">
                <div style="font-size:0.8rem; color:var(--text-muted); margin-bottom:10px;">
                    <i class="ph ph-chats-teardrop"></i> Kontakte
                </div>
                <div style="text-align:center; color:var(--text-muted); padding-top:20px; font-size:0.8rem;">Keine offenen DMs in diesem Kontext.</div>
            </div>
        </div>

        <!-- VIEW 1: DASHBOARD (New Default) -->
        <div id="dashboard-container" class="view-container active">
            
            <!-- SECTION 1: GLOBAL TRENDING -->
            <section>
                <div class="section-title"><i class="ph ph-trend-up"></i> Trending Hubs in diesem Meta Hub(Global)</div>
                <div class="trending-grid">
                    <div class="trend-card">
                        <div class="trend-icon"><i class="ph ph-globe-stand"></i></div>
                        <div>
                            <div class="trend-label">IPCC Data Explorer</div>
                            <div class="trend-meta">Updated: Heute ‚Ä¢ 12k Nodes</div>
                        </div>
                    </div>
                    <div class="trend-card">
                        <div class="trend-icon"><i class="ph ph-waves"></i></div>
                        <div>
                            <div class="trend-label">Ocean Cleanup DAO</div>
                            <div class="trend-meta">High Activity ‚Ä¢ 5k Members</div>
                        </div>
                    </div>
                    <div class="trend-card">
                        <div class="trend-icon"><i class="ph ph-lightning"></i></div>
                        <div>
                            <div class="trend-label">Energy Transition EU</div>
                            <div class="trend-meta">Policy ‚Ä¢ New Regulation</div>
                        </div>
                    </div>
                    <div class="trend-card">
                        <div class="trend-icon"><i class="ph ph-tree"></i></div>
                        <div>
                            <div class="trend-label">Reforest Protocol</div>
                            <div class="trend-meta">Action ‚Ä¢ 3 Projects</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION 2: META-HUB CLUSTERS -->
            <section>
                <div class="section-title"><i class="ph ph-circles-three-plus"></i> Clusters im Meta-Hub</div>
                <div class="cluster-grid">
                    <!-- Science -->
                    <div class="cluster-panel science">
                        <div class="cluster-header">
                            <span class="cluster-title">Science & Data</span>
                            <i class="ph ph-atom" style="font-size:1.5rem; color:var(--accent-deep);"></i>
                        </div>
                        <div style="font-size:0.85rem; color:var(--text-muted);">
                            Harte Fakten, Studien und Rohdaten. Fokus auf Validit√§t und Peer-Review.
                        </div>
                        <div class="cluster-stat">
                            <div class="stat-box">
                                <small>Sources</small> <strong>142</strong>
                            </div>
                            <div class="stat-box">
                                <small>Trust Score</small> <strong style="color:var(--climate-green);">98%</strong>
                            </div>
                        </div>
                    </div>

                    <!-- Politics -->
                    <div class="cluster-panel politics">
                        <div class="cluster-header">
                            <span class="cluster-title">Politics & Governance</span>
                            <i class="ph ph-bank" style="font-size:1.5rem; color:var(--project-color);"></i>
                        </div>
                        <div style="font-size:0.85rem; color:var(--text-muted);">
                            Gesetze, Verordnungen und lokale Initiativen. Fokus auf Wien/EU.
                        </div>
                        <div class="cluster-stat">
                            <div class="stat-box">
                                <small>Debates</small> <strong>12</strong>
                            </div>
                            <div class="stat-box">
                                <small>Pending</small> <strong style="color:#f59e0b;">3 Acts</strong>
                            </div>
                        </div>
                    </div>

                    <!-- Activism -->
                    <div class="cluster-panel activism">
                        <div class="cluster-header">
                            <span class="cluster-title">Activism & Social</span>
                            <i class="ph ph-megaphone" style="font-size:1.5rem; color:var(--accent-flow);"></i>
                        </div>
                        <div style="font-size:0.85rem; color:var(--text-muted);">
                            Events, Demos und Community-Projekte. Fokus auf Vernetzung.
                        </div>
                        <div class="cluster-stat">
                            <div class="stat-box">
                                <small>Members</small> <strong>2.4k</strong>
                            </div>
                            <div class="stat-box">
                                <small>Next Event</small> <strong style="color:#fff;">Morgen</strong>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION 3: SUGGESTIONS (USER FOCUSED) -->
            <section>
                <div class="section-title"><i class="ph ph-sparkle"></i> F√ºr Martin vorgeschlagen</div>
                <div class="suggestion-list">
                    
                    <!-- Highlighted Suggestion -->
                    <div class="suggestion-card" onclick="window.location.href='regio.html'">
                        <div class="sugg-content">
                            <div class="sugg-icon"><i class="ph ph-map-pin"></i></div>
                            <div>
                                <div style="font-weight:bold; font-size:1.1rem; color:var(--climate-green);">Regionaler Hub: Klimawandel Gruppe Wien</div>
                                <div style="font-size:0.85rem; color:var(--text-muted);">Basierend auf deinem Standort. Treffen, lokale Daten und Werkstatt-Projekte.</div>
                            </div>
                        </div>
                        <button class="sugg-btn">Beitreten &rarr;</button>
                    </div>

                    <!-- Secondary Suggestion -->
                    <div class="suggestion-card secondary-sugg">
                        <div class="sugg-content">
                            <div class="sugg-icon"><i class="ph ph-recycle"></i></div>
                            <div>
                                <div style="font-weight:bold;">Circular Economy: Materialb√∂rse</div>
                                <div style="font-size:0.85rem; color:var(--text-muted);">Passt zu deinem Interesse "Handwerk". Holz & Metall wiederverwenden.</div>
                            </div>
                        </div>
                        <button class="sugg-btn">Ansehen</button>
                    </div>

                </div>
            </section>
        </div>

        <!-- VIEW 2: GRAPH -->
        <div id="graph-container" class="view-container"></div>

        <!-- VIEW 3: MAP -->
        <div id="map-container" class="view-container">
            <div class="map-pin project-loc" style="top:48%; left:65%; width:60px; height:60px; font-size:1.5rem;" title="Globaler Fokus"><i class="ph ph-globe"></i></div>
            <div class="map-pin" style="top:35%; left:45%; width:30px; height:30px;" title="Uni Wien"><i class="ph ph-student" style="font-size:1rem;"></i></div>
             <div class="map-pin" style="top:55%; left:55%; background:#ef4444;" title="Hitze-Insel"><i class="ph ph-thermometer" style="font-size:1rem;"></i></div>
        </div>

        <!-- VIEW 4: FLOW -->
        <div id="flow-container" class="view-container">
            <!-- Content via JS -->
        </div>

    </main>

    <!-- TUTORIAL POPUP (RESTORED) -->
    <div id="tutorial-popup">
        <div class="popup-header" id="popup-drag-handle">
            <span>üéì Meta-Hub Guide</span>
            <i id="minimize-btn" class="ph ph-minus" style="cursor:pointer;" onclick="toggleMinimize()"></i>
        </div>
        <div class="popup-body" id="popup-content">
            <p style="margin-top:0;"><b>Meta-Hub: Klimawandel</b></p>
            <p style="font-size:0.9rem; color:#475569;">
                Dies ist ein Aggregations-Node. Er verbindet Daten, Diskurse und lokale Aktionen.
            </p>
            <ul style="font-size:0.85rem; color:#475569; padding-left:20px;">
                <li>Zentrum: Der Themen-Cluster</li>
                <li>Verbindungen: Wissenschaft, Politik, Aktionen</li>
                <li>Map: Zeigt lokale Initiativen in Wien</li>
            </ul>
        </div>
        <div class="popup-footer" id="popup-footer">
            <a href="tour.html" class="btn-tutorial">Zur√ºck zum Dashboard &rarr;</a>
        </div>
    </div>

    <script>
        // --- DATA & LOGIC ---
        const nodesData = [
            { id: 'climate_root', label: 'THEMA:\nKlimawandel', shape: 'hexagon', size: 60, borderWidth: 4, color:{background:'#064e3b', border:'#10b981'}, font:{color:'#10b981', size:18}, group:'project' },
            { id: 'me', label: 'Martin', shape: 'circularImage', image: "https://api.dicebear.com/7.x/avataaars/svg?seed=Martin1&backgroundColor=b6e3f4", size: 25, color:{border:'#38bdf8'}, group:'anchor' },
            { id: 'science', label: 'Wissenschaft', shape:'dot', size:20, color:{background:'#1e293b', border:'#38bdf8'} },
            { id: 'politics', label: 'Politik', shape:'dot', size:20, color:{background:'#1e293b', border:'#f59e0b'} },
            { id: 'activism', label: 'Aktivismus', shape:'dot', size:20, color:{background:'#1e293b', border:'#f472b6'} }
        ];

        const edgesData = [
            { from: 'me', to: 'climate_root', dashes:true },
            { from: 'climate_root', to: 'science' },
            { from: 'climate_root', to: 'politics' },
            { from: 'climate_root', to: 'activism' }
        ];

        const flowData = [
            { title: "Breaking: Neuer IPCC Bericht", tag: "#Science", img: "üìä", warning: true, warningText: "Dringend handeln" },
            { title: "Wien: Fassadenbegr√ºnung", tag: "#Local", img: "üåø", warning: false },
            { title: "Event: Kleidertausch-Party", tag: "#Social", img: "üëï", warning: false }
        ];

        let network;

        function init() {
            // Setup Vis.js
            const nodes = new vis.DataSet(nodesData);
            const edges = new vis.DataSet(edgesData);
            const container = document.getElementById('graph-container');
            network = new vis.Network(container, { nodes, edges }, {
                nodes: { font: { color: '#cbd5e1', face: 'Inter' }, borderWidth: 2 },
                groups: { project: { shape: 'hexagon' } },
                edges: { color: '#475569' }
            });
            renderFlow();
        }

        // --- MODE SWITCHING ---
        function setMode(mode) {
            // UI Button State
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.className = 'mode-btn'; 
            });
            const activeClass = mode === 'dash' ? 'active-dash' : 
                                mode === 'deep' ? 'active-deep' : 
                                mode === 'connect' ? 'active-connect' : 'active-flow';
            document.querySelector(`.mode-btn[onclick="setMode('${mode}')"]`).classList.add(activeClass);

            // Container Visibility
            document.querySelectorAll('.view-container').forEach(el => el.classList.remove('active'));
            
            if(mode === 'dash') document.getElementById('dashboard-container').classList.add('active');
            if(mode === 'deep') document.getElementById('graph-container').classList.add('active');
            if(mode === 'connect') document.getElementById('map-container').classList.add('active');
            if(mode === 'flow') document.getElementById('flow-container').classList.add('active');
        }

        // --- TOOLS PANEL TOGGLE ---
        function toggleToolsPanel() {
            const panel = document.getElementById('tools-panel');
            panel.classList.toggle('expanded');
        }

        function toggleTool(el) { el.classList.toggle('active'); }

        // --- COMM PANEL ---
        function switchCommTab(tab) {
            document.querySelectorAll('.comm-tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`.comm-tab[onclick="switchCommTab('${tab}')"]`).classList.add('active');
            document.querySelectorAll('.comm-body').forEach(b => b.classList.remove('active'));
            document.getElementById('comm-' + tab).classList.add('active');
        }

        function toggleCommPanel() {
            const p = document.getElementById('comm-panel');
            const icon = document.getElementById('comm-icon');
            p.classList.toggle('minimized');
            icon.className = p.classList.contains('minimized') ? 'ph ph-caret-down' : 'ph ph-caret-up';
        }

        function switchLens(el, lens) {
            if(lens === 'home' || lens === 'mynodes') { window.location.href='tour.html'; return; }
            document.querySelectorAll('.lens-item').forEach(i => i.classList.remove('active'));
            if(el.classList.contains('lens-item')) el.classList.add('active');
        }

        function renderFlow() {
            const container = document.getElementById('flow-container');
            container.innerHTML = flowData.map(item => `
                <div class="flow-card">
                    <div class="card-img">${item.img}</div>
                    <div class="card-body">
                        <div class="card-tag">${item.tag}</div>
                        <div style="font-weight:bold; margin-top:5px;">${item.title}</div>
                        ${item.warning ? `<div class="card-warning"><i class="ph ph-warning"></i> ${item.warningText}</div>` : ''}
                    </div>
                </div>
            `).join('');
        }

        // --- POPUP LOGIC ---
        const popup = document.getElementById("tutorial-popup");
        const handle = document.getElementById("popup-drag-handle");
        
        let isDragging = false;
        let startX, startY, initialLeft, initialTop;

        handle.addEventListener("mousedown", (e) => {
            if(e.target.id === 'minimize-btn') return;
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            const rect = popup.getBoundingClientRect();
            initialLeft = rect.left;
            initialTop = rect.top;
            popup.style.right = "auto"; 
            popup.style.left = initialLeft + "px";
            popup.style.top = initialTop + "px";
            handle.style.cursor = "grabbing";
        });

        document.addEventListener("mousemove", (e) => {
            if (!isDragging) return;
            const dx = e.clientX - startX;
            const dy = e.clientY - startY;
            popup.style.left = `${initialLeft + dx}px`;
            popup.style.top = `${initialTop + dy}px`;
        });

        document.addEventListener("mouseup", () => {
            isDragging = false;
            handle.style.cursor = "move";
        });

        function toggleMinimize() {
            const content = document.getElementById('popup-content');
            const footer = document.getElementById('popup-footer');
            const btn = document.getElementById('minimize-btn');
            
            if (content.style.display === 'none') {
                content.style.display = 'block';
                footer.style.display = 'block';
                btn.classList.remove('ph-plus');
                btn.classList.add('ph-minus');
            } else {
                content.style.display = 'none';
                footer.style.display = 'none';
                btn.classList.remove('ph-minus');
                btn.classList.add('ph-plus');
            }
        }

        window.onload = init;
    </script>
</body>
</html>